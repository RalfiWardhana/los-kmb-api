package usecase

import (
	"context"
	"encoding/json"
	"errors"
	"los-kmb-api/domain/filtering_new/interfaces/mocks"
	"los-kmb-api/models/entity"
	"los-kmb-api/models/request"
	"los-kmb-api/models/response"
	"los-kmb-api/shared/constant"
	"los-kmb-api/shared/httpclient"
	"los-kmb-api/shared/utils"
	"os"
	"strconv"
	"strings"
	"testing"
	"time"

	"github.com/go-resty/resty/v2"
	"github.com/jarcoal/httpmock"
	jsoniter "github.com/json-iterator/go"
	"github.com/stretchr/testify/mock"
	"github.com/stretchr/testify/require"
)

func TestFilteringProspectID(t *testing.T) {
	testcases := []struct {
		name       string
		prospectID string
		row        int
		result     request.OrderIDCheck
		errGet     error
		errFinal   error
	}{
		{
			name:       "test error",
			prospectID: "TEST01",
			result: request.OrderIDCheck{
				ProspectID: "TEST01 - true",
			},
			errGet:   errors.New("upstream_service_error - Get Filtering Order ID"),
			errFinal: errors.New("upstream_service_error - Get Filtering Order ID"),
		},
		{
			name:       "test ppid exist",
			prospectID: "TEST01",
			result: request.OrderIDCheck{
				ProspectID: "TEST01 - false",
			},
			row: 1,
		},
	}

	for _, tc := range testcases {
		t.Run(tc.name, func(t *testing.T) {
			mockRepository := new(mocks.Repository)
			mockHttpClient := new(httpclient.MockHttpClient)

			mockRepository.On("GetFilteringByID", mock.Anything).Return(tc.row, tc.errGet)

			usecase := NewUsecase(mockRepository, mockHttpClient)

			result, err := usecase.FilteringProspectID(tc.prospectID)
			require.Equal(t, tc.result, result)
			require.Equal(t, tc.errFinal, err)
		})
	}
}

func TestSaveFiltering(t *testing.T) {
	testcases := []struct {
		name                string
		transaction         entity.FilteringKMB
		trxDetailBiro       []entity.TrxDetailBiro
		transactionCMOnoFPD entity.TrxCmoNoFPD
		errSave             error
		errFinal            error
	}{
		{
			name:     "test error timeout",
			errSave:  errors.New("connection deadline"),
			errFinal: errors.New("upstream_service_timeout - Save Filtering Timeout"),
		},
		{
			name:     "test error save",
			errSave:  errors.New("save error"),
			errFinal: errors.New(constant.ERROR_BAD_REQUEST + " - Save Filtering Error ProspectID Already Exist"),
		},
	}
	for _, tc := range testcases {
		t.Run(tc.name, func(t *testing.T) {
			mockRepository := new(mocks.Repository)
			mockHttpClient := new(httpclient.MockHttpClient)

			mockRepository.On("SaveFiltering", mock.Anything, mock.Anything, mock.Anything).Return(tc.errSave)

			usecase := NewUsecase(mockRepository, mockHttpClient)

			err := usecase.SaveFiltering(tc.transaction, tc.trxDetailBiro, tc.transactionCMOnoFPD)
			require.Equal(t, tc.errFinal, err)
		})
	}
}

func TestBlacklistCheck(t *testing.T) {
	testcases := []struct {
		name         string
		spCustomer   response.SpDupCekCustomerByID
		index        int
		customerType string
		res          response.UsecaseApi
	}{
		{
			name:         "test new",
			customerType: constant.MESSAGE_BERSIH,
			res: response.UsecaseApi{
				Result:         constant.DECISION_PASS,
				Code:           constant.CODE_NON_BLACKLIST_ALL,
				Reason:         constant.REASON_NON_BLACKLIST,
				StatusKonsumen: constant.STATUS_KONSUMEN_NEW,
			},
		},
		{
			name: "test ro BadType",
			spCustomer: response.SpDupCekCustomerByID{
				CustomerStatus:        constant.STATUS_KONSUMEN_RO,
				BadType:               constant.BADTYPE_B,
				MaxOverdueDays:        91,
				NumOfAssetInventoried: 1,
				IsRestructure:         1,
			},
			customerType: constant.MESSAGE_BLACKLIST,
			res: response.UsecaseApi{
				Result:         constant.DECISION_REJECT,
				Code:           constant.CODE_KONSUMEN_BLACKLIST,
				Reason:         constant.REASON_KONSUMEN_BLACKLIST,
				StatusKonsumen: constant.STATUS_KONSUMEN_RO,
			},
		},
		{
			name:  "test ro pasangan BadType",
			index: 1,
			spCustomer: response.SpDupCekCustomerByID{
				CustomerStatus:        constant.STATUS_KONSUMEN_RO,
				BadType:               constant.BADTYPE_B,
				MaxOverdueDays:        91,
				NumOfAssetInventoried: 1,
				IsRestructure:         1,
			},
			customerType: constant.MESSAGE_BLACKLIST,
			res: response.UsecaseApi{
				Result:         constant.DECISION_REJECT,
				Code:           constant.CODE_PASANGAN_BLACKLIST,
				Reason:         constant.REASON_PASANGAN_BLACKLIST,
				StatusKonsumen: constant.STATUS_KONSUMEN_RO,
			},
		},
		{
			name: "test ro MaxOverdueDays",
			spCustomer: response.SpDupCekCustomerByID{
				CustomerStatus:        constant.STATUS_KONSUMEN_RO,
				MaxOverdueDays:        91,
				NumOfAssetInventoried: 1,
				IsRestructure:         1,
			},
			customerType: constant.MESSAGE_BLACKLIST,
			res: response.UsecaseApi{
				Result:         constant.DECISION_REJECT,
				Code:           constant.CODE_KONSUMEN_BLACKLIST,
				Reason:         constant.REASON_KONSUMEN_BLACKLIST_OVD_90DAYS,
				StatusKonsumen: constant.STATUS_KONSUMEN_RO,
			},
		},
		{
			name:  "test ro pasangan MaxOverdueDays",
			index: 1,
			spCustomer: response.SpDupCekCustomerByID{
				CustomerStatus:        constant.STATUS_KONSUMEN_RO,
				MaxOverdueDays:        91,
				NumOfAssetInventoried: 1,
				IsRestructure:         1,
			},
			customerType: constant.MESSAGE_BLACKLIST,
			res: response.UsecaseApi{
				Result:         constant.DECISION_REJECT,
				Code:           constant.CODE_PASANGAN_BLACKLIST,
				Reason:         constant.REASON_PASANGAN_BLACKLIST_OVD_90DAYS,
				StatusKonsumen: constant.STATUS_KONSUMEN_RO,
			},
		},
		{
			name: "test ro NumOfAssetInventoried",
			spCustomer: response.SpDupCekCustomerByID{
				CustomerStatus:        constant.STATUS_KONSUMEN_RO,
				NumOfAssetInventoried: 1,
				IsRestructure:         1,
			},
			customerType: constant.MESSAGE_BLACKLIST,
			res: response.UsecaseApi{
				Result:         constant.DECISION_REJECT,
				Code:           constant.CODE_KONSUMEN_BLACKLIST,
				Reason:         constant.REASON_KONSUMEN_BLACKLIST_ASSET_INVENTORY,
				StatusKonsumen: constant.STATUS_KONSUMEN_RO,
			},
		},
		{
			name:  "test ro pasangan NumOfAssetInventoried",
			index: 1,
			spCustomer: response.SpDupCekCustomerByID{
				CustomerStatus:        constant.STATUS_KONSUMEN_RO,
				NumOfAssetInventoried: 1,
				IsRestructure:         1,
			},
			customerType: constant.MESSAGE_BLACKLIST,
			res: response.UsecaseApi{
				Result:         constant.DECISION_REJECT,
				Code:           constant.CODE_PASANGAN_BLACKLIST,
				Reason:         constant.REASON_PASANGAN_BLACKLIST_ASSET_INVENTORY,
				StatusKonsumen: constant.STATUS_KONSUMEN_RO,
			},
		},
		{
			name: "test ro IsRestructure",
			spCustomer: response.SpDupCekCustomerByID{
				CustomerStatus: constant.STATUS_KONSUMEN_RO,
				IsRestructure:  1,
			},
			customerType: constant.MESSAGE_BLACKLIST,
			res: response.UsecaseApi{
				Result:         constant.DECISION_REJECT,
				Code:           constant.CODE_KONSUMEN_BLACKLIST,
				Reason:         constant.REASON_KONSUMEN_BLACKLIST_RESTRUCTURE,
				StatusKonsumen: constant.STATUS_KONSUMEN_RO,
			},
		},
		{
			name:  "test ro pasangan IsRestructure",
			index: 1,
			spCustomer: response.SpDupCekCustomerByID{
				CustomerStatus: constant.STATUS_KONSUMEN_RO,
				IsRestructure:  1,
			},
			customerType: constant.MESSAGE_BLACKLIST,
			res: response.UsecaseApi{
				Result:         constant.DECISION_REJECT,
				Code:           constant.CODE_PASANGAN_BLACKLIST,
				Reason:         constant.REASON_PASANGAN_BLACKLIST_RESTRUCTURE,
				StatusKonsumen: constant.STATUS_KONSUMEN_RO,
			},
		},
		{
			name: "test new sp",
			spCustomer: response.SpDupCekCustomerByID{
				CustomerID: 12345,
			},
			customerType: constant.MESSAGE_BERSIH,
			res: response.UsecaseApi{
				Result:         constant.DECISION_PASS,
				Code:           constant.CODE_NON_BLACKLIST_ALL,
				Reason:         constant.REASON_NON_BLACKLIST,
				StatusKonsumen: constant.STATUS_KONSUMEN_NEW,
			},
		},
	}

	for _, tc := range testcases {
		t.Run(tc.name, func(t *testing.T) {
			mockRepository := new(mocks.Repository)
			mockHttpClient := new(httpclient.MockHttpClient)

			usecase := NewUsecase(mockRepository, mockHttpClient)

			result, ct := usecase.BlacklistCheck(tc.index, tc.spCustomer)
			require.Equal(t, tc.res, result)
			require.Equal(t, tc.customerType, ct)
		})
	}
}

func TestFiltering(t *testing.T) {
	os.Setenv("NAMA_SAMA", "K,P")

	accessToken := "token"
	hrisAccessToken := "hristoken"
	ctx := context.Background()
	reqID := utils.GenerateUUID()
	ctx = context.WithValue(ctx, constant.HeaderXRequestID, reqID)

	testcases := []struct {
		name                             string
		req                              request.Filtering
		married                          bool
		spCustomer                       response.SpDupCekCustomerByID
		errspCustomer                    error
		spSpouse                         response.SpDupCekCustomerByID
		errspSpouse                      error
		resBlackList                     response.UsecaseApi
		respFilteringPefindo             response.Filtering
		reqPefindo                       request.Pefindo
		resPefindo                       response.PefindoResult
		errpefindo                       error
		trxDetailBiro                    []entity.TrxDetailBiro
		resEmployee                      response.EmployeeCMOResponse
		errEmployee                      error
		resFPD                           response.FpdCMOResponse
		errFPD                           error
		entityFPDCluster                 entity.MasterMappingFpdCluster
		errMapFpdCluster                 error
		resFinal                         response.Filtering
		errFinal                         error
		rrdDate_LatestPaidInstallment    string
		monthsDiff_LatestPaidInstallment int
		err_LatestPaidInstallment        error
		config                           entity.AppConfig
		errGetConfig                     error
	}{
		{
			name: "TEST_ERROR_DupcheckIntegrator",
			req: request.Filtering{
				ProspectID: "SAL02400020230727001",
				BPKBName:   "K",
				BranchID:   "426",
				IDNumber:   "3275066006789999",
				LegalName:  "EMI LegalName",
				BirthDate:  "1971-04-15",
				Gender:     "M",
				MotherName: "HAROEMI MotherName",
				Spouse: &request.FilteringSpouse{
					IDNumber:   "3345270510910123",
					LegalName:  "DIANA LegalName",
					BirthDate:  "1995-08-28",
					Gender:     "F",
					MotherName: "ELSA",
				},
				CMOID: "105394",
			},
			married:       true,
			errspCustomer: errors.New("error sp"),
			errFinal:      errors.New("error sp"),
		},
		{
			name: "TEST_Reject_BlacklistCheck",
			req: request.Filtering{
				ProspectID: "SAL02400020230727001",
				BPKBName:   "K",
				BranchID:   "426",
				IDNumber:   "3275066006789999",
				LegalName:  "EMI LegalName",
				BirthDate:  "1971-04-15",
				Gender:     "M",
				MotherName: "HAROEMI MotherName",
				Spouse: &request.FilteringSpouse{
					IDNumber:   "3345270510910123",
					LegalName:  "DIANA LegalName",
					BirthDate:  "1995-08-28",
					Gender:     "F",
					MotherName: "ELSA",
				},
				CMOID: "105394",
			},
			married: true,
			resBlackList: response.UsecaseApi{
				Result: constant.DECISION_REJECT,
				Code:   "123",
			},
			resFinal: response.Filtering{
				ProspectID:  "SAL02400020230727001",
				Decision:    constant.DECISION_REJECT,
				Code:        "123",
				IsBlacklist: true,
			},
		},
		{
			name: "TEST_err_FilteringPefindo_01",
			req: request.Filtering{
				ProspectID: "SAL02400020230727001",
				BPKBName:   "K",
				BranchID:   "426",
				IDNumber:   "3275066006789999",
				LegalName:  "EMI LegalName",
				BirthDate:  "1971-04-15",
				Gender:     "M",
				MotherName: "HAROEMI MotherName",
				Spouse: &request.FilteringSpouse{
					IDNumber:   "3345270510910123",
					LegalName:  "DIANA LegalName",
					BirthDate:  "1995-08-28",
					Gender:     "F",
					MotherName: "ELSA",
				},
				CMOID: "105394",
			},
			resEmployee: response.EmployeeCMOResponse{
				EmployeeID:         "105394",
				EmployeeName:       "SUSANAH",
				EmployeeIDWithName: "105394 - SUSANAH",
				JoinDate:           "2023-07-24",
				PositionGroupCode:  "AO",
				PositionGroupName:  "Marketing",
				CMOCategory:        "OLD",
			},
			resFPD: response.FpdCMOResponse{
				FpdExist:    true,
				CmoFpd:      22,
				CmoAccSales: 47,
			},
			entityFPDCluster: entity.MasterMappingFpdCluster{
				Cluster:     "Cluster E",
				FpdStartHte: 20,
				FpdEndLt:    25,
				CreatedAt:   time.Time{},
			},
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			married:    true,
			errpefindo: errors.New("error pefindo"),
			errFinal:   errors.New("error pefindo"),
		},
		{
			name: "TEST_err_FilteringPefindo_02",
			req: request.Filtering{
				ProspectID: "SAL02400020230727001",
				BPKBName:   "K",
				BranchID:   "426",
				IDNumber:   "3275066006789999",
				LegalName:  "EMI LegalName",
				BirthDate:  "1971-04-15",
				Gender:     "M",
				MotherName: "HAROEMI MotherName",
				Spouse: &request.FilteringSpouse{
					IDNumber:   "3345270510910123",
					LegalName:  "DIANA LegalName",
					BirthDate:  "1995-08-28",
					Gender:     "F",
					MotherName: "ELSA",
				},
				CMOID: "105394",
			},
			resEmployee: response.EmployeeCMOResponse{
				EmployeeID:         "105394",
				EmployeeName:       "SUSANAH",
				EmployeeIDWithName: "105394 - SUSANAH",
				JoinDate:           "2023-07-24",
				PositionGroupCode:  "AO",
				PositionGroupName:  "Marketing",
				CMOCategory:        "OLD",
			},
			resFPD: response.FpdCMOResponse{
				FpdExist:    true,
				CmoFpd:      22,
				CmoAccSales: 47,
			},
			entityFPDCluster: entity.MasterMappingFpdCluster{
				Cluster:     "Cluster E",
				FpdStartHte: 20,
				FpdEndLt:    25,
				CreatedAt:   time.Time{},
			},
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			spCustomer: response.SpDupCekCustomerByID{
				CustomerStatus:  constant.STATUS_KONSUMEN_RO,
				CustomerSegment: constant.RO_AO_PRIME,
				CustomerID:      "14045",
			},
			resBlackList: response.UsecaseApi{
				Result: constant.DECISION_PASS,
				Code:   "123",
			},
			married: true,
			respFilteringPefindo: response.Filtering{
				ProspectID:      "SAL02400020230727001",
				Decision:        constant.DECISION_PASS,
				CustomerStatus:  constant.STATUS_KONSUMEN_RO,
				CustomerSegment: constant.RO_AO_REGULAR,
				NextProcess:     true,
				Code:            "123",
			},
			resPefindo: response.PefindoResult{
				Score:       "Average Risk",
				WoContract:  true,
				WoAdaAgunan: true,
			},
			resFinal: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Decision:          constant.DECISION_PASS,
				CustomerStatus:    constant.STATUS_KONSUMEN_RO,
				CustomerStatusKMB: constant.STATUS_KONSUMEN_NEW,
				CustomerSegment:   constant.RO_AO_PRIME,
				NextProcess:       true,
				Code:              "123",
				Reason:            "RO PRIME",
				ClusterCMO:        "Cluster E",
			},
			config: entity.AppConfig{
				Key:   "expired_contract_check",
				Value: `{"data":{"expired_contract_check_enabled":true,"expired_contract_max_months":6}}`,
			},
			rrdDate_LatestPaidInstallment:    time.Now().AddDate(0, -3, 0).Format("2006-01-02"),
			monthsDiff_LatestPaidInstallment: 3,
			err_LatestPaidInstallment:        nil,
		},
		{
			name: "TEST_err_FilteringPefindo_02_RO_PRIME_Expired_7_months",
			req: request.Filtering{
				ProspectID: "SAL02400020230727001",
				BPKBName:   "K",
				BranchID:   "426",
				IDNumber:   "3275066006789999",
				LegalName:  "EMI LegalName",
				BirthDate:  "1971-04-15",
				Gender:     "M",
				MotherName: "HAROEMI MotherName",
				Spouse: &request.FilteringSpouse{
					IDNumber:   "3345270510910123",
					LegalName:  "DIANA LegalName",
					BirthDate:  "1995-08-28",
					Gender:     "F",
					MotherName: "ELSA",
				},
				CMOID: "105394",
			},
			resEmployee: response.EmployeeCMOResponse{
				EmployeeID:         "105394",
				EmployeeName:       "SUSANAH",
				EmployeeIDWithName: "105394 - SUSANAH",
				JoinDate:           "2023-07-24",
				PositionGroupCode:  "AO",
				PositionGroupName:  "Marketing",
				CMOCategory:        "OLD",
			},
			resFPD: response.FpdCMOResponse{
				FpdExist:    true,
				CmoFpd:      22,
				CmoAccSales: 47,
			},
			entityFPDCluster: entity.MasterMappingFpdCluster{
				Cluster:     "Cluster E",
				FpdStartHte: 20,
				FpdEndLt:    25,
				CreatedAt:   time.Time{},
			},
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			spCustomer: response.SpDupCekCustomerByID{
				CustomerStatus:  constant.STATUS_KONSUMEN_RO,
				CustomerSegment: constant.RO_AO_PRIME,
				CustomerID:      "14045",
			},
			resBlackList: response.UsecaseApi{
				Result: constant.DECISION_PASS,
				Code:   "123",
			},
			married: true,
			respFilteringPefindo: response.Filtering{
				ProspectID:      "SAL02400020230727001",
				Decision:        constant.DECISION_PASS,
				CustomerStatus:  constant.STATUS_KONSUMEN_RO,
				CustomerSegment: constant.RO_AO_PRIME,
				Reason:          constant.STATUS_KONSUMEN_RO + constant.RO_AO_PRIME,
				NextProcess:     true,
				Code:            "123",
			},
			resPefindo: response.PefindoResult{
				Score:       "Average Risk",
				WoContract:  true,
				WoAdaAgunan: true,
			},
			resFinal: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Decision:          constant.DECISION_PASS,
				CustomerStatus:    constant.STATUS_KONSUMEN_RO,
				CustomerStatusKMB: constant.STATUS_KONSUMEN_NEW,
				CustomerSegment:   constant.RO_AO_PRIME,
				NextProcess:       true,
				Code:              "123",
				Reason:            constant.EXPIRED_CONTRACT_HIGHERTHAN_6MONTHS + constant.STATUS_KONSUMEN_RO + constant.RO_AO_PRIME,
				ClusterCMO:        "Cluster E",
			},
			config: entity.AppConfig{
				Key:   "expired_contract_check",
				Value: `{"data":{"expired_contract_check_enabled":true,"expired_contract_max_months":6}}`,
			},
			rrdDate_LatestPaidInstallment:    time.Now().AddDate(0, -7, 0).Format("2006-01-02"),
			monthsDiff_LatestPaidInstallment: 7,
			err_LatestPaidInstallment:        nil,
		},
		{
			name: "TEST_err_Filtering_RO_PRIME",
			req: request.Filtering{
				ProspectID: "SAL02400020230727001",
				BPKBName:   "K",
				BranchID:   "426",
				IDNumber:   "3275066006789999",
				LegalName:  "EMI LegalName",
				BirthDate:  "1971-04-15",
				Gender:     "M",
				MotherName: "HAROEMI MotherName",
				Spouse: &request.FilteringSpouse{
					IDNumber:   "3345270510910123",
					LegalName:  "DIANA LegalName",
					BirthDate:  "1995-08-28",
					Gender:     "F",
					MotherName: "ELSA",
				},
				CMOID: "105394",
			},
			resEmployee: response.EmployeeCMOResponse{
				EmployeeID:         "105394",
				EmployeeName:       "SUSANAH",
				EmployeeIDWithName: "105394 - SUSANAH",
				JoinDate:           "2023-07-24",
				PositionGroupCode:  "AO",
				PositionGroupName:  "Marketing",
				CMOCategory:        "OLD",
			},
			resFPD: response.FpdCMOResponse{
				FpdExist:    true,
				CmoFpd:      22,
				CmoAccSales: 47,
			},
			entityFPDCluster: entity.MasterMappingFpdCluster{
				Cluster:     "Cluster E",
				FpdStartHte: 20,
				FpdEndLt:    25,
				CreatedAt:   time.Time{},
			},
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			spCustomer: response.SpDupCekCustomerByID{
				CustomerStatus:  constant.STATUS_KONSUMEN_RO,
				CustomerSegment: constant.RO_AO_PRIME,
				CustomerID:      nil,
			},
			resBlackList: response.UsecaseApi{
				Result: constant.DECISION_PASS,
				Code:   "123",
			},
			married: true,
			respFilteringPefindo: response.Filtering{
				ProspectID:      "SAL02400020230727001",
				Decision:        constant.DECISION_PASS,
				CustomerStatus:  constant.STATUS_KONSUMEN_RO,
				CustomerSegment: constant.RO_AO_REGULAR,
				NextProcess:     true,
				Code:            "123",
			},
			resPefindo: response.PefindoResult{
				Score:       "Average Risk",
				WoContract:  true,
				WoAdaAgunan: true,
			},
			resFinal: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Decision:          constant.DECISION_PASS,
				CustomerStatus:    constant.STATUS_KONSUMEN_RO,
				CustomerStatusKMB: constant.STATUS_KONSUMEN_NEW,
				CustomerSegment:   constant.RO_AO_PRIME,
				NextProcess:       true,
				Code:              "123",
				Reason:            "RO PRIME",
				ClusterCMO:        "Cluster E",
			},
			rrdDate_LatestPaidInstallment:    "",
			monthsDiff_LatestPaidInstallment: 0,
			err_LatestPaidInstallment:        errors.New(constant.ERROR_BAD_REQUEST + " - Customer RO then CustomerID should not be empty"),
			errFinal:                         errors.New(constant.ERROR_BAD_REQUEST + " - Customer RO then CustomerID should not be empty"),
		},
	}
	for _, tc := range testcases {
		t.Run(tc.name, func(t *testing.T) {
			mockUsecase := new(mocks.Usecase)
			mockRepository := new(mocks.Repository)
			mockHttpClient := new(httpclient.MockHttpClient)

			mockUsecase.On("SaveFiltering", mock.Anything, mock.Anything, mock.Anything).Return(nil)

			mockUsecase.On("DupcheckIntegrator", ctx, tc.req.ProspectID, tc.req.IDNumber, tc.req.LegalName, tc.req.BirthDate, tc.req.MotherName, accessToken).Return(tc.spCustomer, tc.errspCustomer).Once()
			if tc.married {
				mockUsecase.On("DupcheckIntegrator", ctx, tc.req.ProspectID, tc.req.Spouse.IDNumber, tc.req.Spouse.LegalName, tc.req.Spouse.BirthDate, tc.req.Spouse.MotherName, accessToken).Return(tc.spSpouse, tc.errspSpouse).Once()
			}

			mockUsecase.On("BlacklistCheck", 0, tc.spCustomer).Return(tc.resBlackList, mock.Anything).Once()
			if tc.married {
				mockUsecase.On("BlacklistCheck", 1, tc.spSpouse).Return(tc.resBlackList, mock.Anything).Once()
			}

			mockUsecase.On("FilteringPefindo", ctx, tc.reqPefindo, mock.Anything, mock.Anything, mock.Anything, accessToken).Return(tc.respFilteringPefindo, tc.resPefindo, tc.trxDetailBiro, tc.errpefindo).Once()

			customerID, ok := tc.spCustomer.CustomerID.(string)
			if !ok {
				customerID = ""
			}

			mockRepository.On("GetConfig", "expired_contract", "KMB-OFF", "expired_contract_check").Return(tc.config, tc.errGetConfig)

			mockUsecase.On("CheckLatestPaidInstallment", ctx, tc.req.ProspectID, customerID, accessToken).Return(tc.rrdDate_LatestPaidInstallment, tc.monthsDiff_LatestPaidInstallment, tc.err_LatestPaidInstallment).Once()

			mockUsecase.On("GetEmployeeData", ctx, tc.req.CMOID, accessToken, hrisAccessToken).Return(tc.resEmployee, tc.errEmployee).Once()

			bpkbName := strings.Contains(os.Getenv("NAMA_SAMA"), tc.req.BPKBName)
			bpkbString := "NAMA BEDA"
			if bpkbName {
				bpkbString = "NAMA SAMA"
			}
			mockUsecase.On("GetFpdCMO", ctx, tc.req.CMOID, bpkbString, accessToken).Return(tc.resFPD, tc.errFPD).Once()

			mockRepository.On("MasterMappingFpdCluster", tc.resFPD.CmoFpd).Return(tc.entityFPDCluster, tc.errMapFpdCluster)

			multiUsecase := NewMultiUsecase(mockRepository, mockHttpClient, mockUsecase)

			result, err := multiUsecase.Filtering(ctx, tc.req, tc.married, accessToken, hrisAccessToken)

			require.Equal(t, tc.resFinal, result)
			require.Equal(t, tc.errFinal, err)
		})
	}
}

func TestFilteringPefindo(t *testing.T) {
	os.Setenv("NAMA_SAMA", "K,P")
	os.Setenv("ACTIVE_PBK", "true")
	os.Setenv("DUMMY_PBK", "false")
	timeOut, _ := strconv.Atoi(os.Getenv("DUPCHECK_API_TIMEOUT"))

	accessToken := "token"
	ctx := context.Background()
	reqID := utils.GenerateUUID()
	ctx = context.WithValue(ctx, constant.HeaderXRequestID, reqID)

	pbkCustomer := "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf"
	pbkSpouse := "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79ab36b6d_5793480682.pdf"

	testcases := []struct {
		name                 string
		checkPefindo         response.ResponsePefindo
		pefindoResult        response.PefindoResult
		customerStatus       string
		clusterCMO           string
		isPrimePriority      bool
		reqPefindo           request.Pefindo
		respFilteringPefindo response.Filtering
		resPefindo           response.PefindoResult
		trxDetailBiro        []entity.TrxDetailBiro
		errPefindo           error
		rPefindoCode         int
		rPefindoBody         string
		reqMappingCluster    entity.MasterMappingCluster
		resMappingCluster    entity.MasterMappingCluster
		errMappingCluster    error
		errFinal             error
	}{
		{
			name:           "test pefindo bpkb sama",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0,
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo bpkb sama baki debet 3-20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0,
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) " + constant.WORDING_BAKIDEBET_HIGHERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo bpkb sama baki debet >20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0,
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) & Baki Debet > 20 Juta",
				CustomerStatus:    "RO",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(21000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(21000000),
			},
		},
		{
			name:           "test pefindo bpkb sama new",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0,
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "NEW",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo bpkb sama new baki debet 3-20jt",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0,
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) " + constant.WORDING_BAKIDEBET_HIGHERTHAN_THRESHOLD,
				CustomerStatus:    "NEW",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo bpkb sama new baki debet >20jt",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0,
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) & Baki Debet > 20 Juta",
				CustomerStatus:    "NEW",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(21000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(21000000),
			},
		},
		{
			name:           "test pefindo reject 12 bpkb sama",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":70,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 3,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 70},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":70,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9107",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA SAMA (III) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(70),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(3),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(70),
			},
		},
		{
			name:           "test pefindo reject 12 bpkb sama baki debet 3-20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":70,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 3,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 70},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":70,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9107",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA SAMA (III) " + constant.WORDING_BAKIDEBET_HIGHERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(70),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(3),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(70),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo reject 12 bpkb sama baki debet >20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":70,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 3,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 70},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":70,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9107",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA SAMA (III) & Baki Debet > 20 Juta",
				CustomerStatus:    "RO",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(21000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(70),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(3),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(70),
				TotalBakiDebetNonAgunan:       float64(21000000),
			},
		},
		{
			name:           "test pefindo reject current bpkb sama",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 3,
			"max_overdue_ko_rules": 40,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9107",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA SAMA (III) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(3),
				MaxOverdueKORules:             float64(40),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo reject current bpkb sama baki debet 3-20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 3,
			"max_overdue_ko_rules": 40,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9107",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA SAMA (III) " + constant.WORDING_BAKIDEBET_HIGHERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(3),
				MaxOverdueKORules:             float64(40),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo reject current bpkb sama baki debet >20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 3,
			"max_overdue_ko_rules": 40,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9107",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA SAMA (III) & Baki Debet > 20 Juta",
				CustomerStatus:    "RO",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(21000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(3),
				MaxOverdueKORules:             float64(40),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(21000000),
			},
		},
		{
			name:           "test pefindo reject current bpkb sama baki debet <=3jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":true,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 3,
			"max_overdue_ko_rules": 40,
			"max_overdue_last12months_ko_rules": 70},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":70,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9107",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA SAMA (III) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				WoAdaAgunan:                   true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(3),
				MaxOverdueKORules:             float64(40),
				MaxOverdueLast12MonthsKORules: float64(70),
			},
		},
		{
			name:           "test pefindo reject current bpkb sama baki debet 3-20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":true,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 3,
			"max_overdue_ko_rules": 40,
			"max_overdue_last12months_ko_rules": 70},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":70,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9107",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA SAMA (III) " + constant.WORDING_BAKIDEBET_HIGHERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				WoAdaAgunan:                   true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(3),
				MaxOverdueKORules:             float64(40),
				MaxOverdueLast12MonthsKORules: float64(70),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo reject current bpkb sama baki debet >20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":true,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 3,
			"max_overdue_ko_rules": 40,
			"max_overdue_last12months_ko_rules": 70},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":70,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9107",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA SAMA (III) & Baki Debet > 20 Juta",
				CustomerStatus:    "RO",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(21000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				WoAdaAgunan:                   true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(3),
				MaxOverdueKORules:             float64(40),
				MaxOverdueLast12MonthsKORules: float64(70),
				TotalBakiDebetNonAgunan:       float64(21000000),
			},
		},
		{
			name:           "test pefindo pass current bpkb sama ao/ro",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":true,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 3,
			"max_overdue_ko_rules": 10,
			"max_overdue_last12months_ko_rules": 10},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":70,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (III) & Ada Fasilitas WO Agunan",
				CustomerStatus:    "RO",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				WoAdaAgunan:                   true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(3),
				MaxOverdueKORules:             float64(10),
				MaxOverdueLast12MonthsKORules: float64(10),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo pass bpkb beda baki debet <3jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo pass bpkb beda baki debet 3-20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) " + constant.WORDING_BAKIDEBET_HIGHERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo pass bpkb beda baki debet >20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) & Baki Debet > 20 Juta",
				CustomerStatus:    "RO",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(21000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(21000000),
			},
		},
		{
			name:           "test pefindo pass bpkb beda new baki debet <3jt",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "NEW",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo pass bpkb beda new baki debet 3-20jt",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) " + constant.WORDING_BAKIDEBET_HIGHERTHAN_THRESHOLD,
				CustomerStatus:    "NEW",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo pass bpkb beda new baki debet >20jt",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) & Baki Debet > 20 Juta",
				CustomerStatus:    "NEW",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(21000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(21000000),
			},
		},
		{
			name:           "test pefindo reject bpkb beda new",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 40,
			"max_overdue_last12months_ko_rules": 70},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9107",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA BEDA (I) & Tidak Ada Fasilitas WO Agunan",
				CustomerStatus:    "NEW",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(40),
				MaxOverdueLast12MonthsKORules: float64(70),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo ovd last 12m all reject bpkb beda ",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":61,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":61,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA BEDA & OVD Tidak sesuai ketentuan",
				CustomerStatus:    "RO",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(61),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo ovd current all reject current bpkb beda",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 3,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA BEDA & OVD Tidak sesuai ketentuan",
				CustomerStatus:    "RO",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(3),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo reject current bpkb beda",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":null,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":null,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":null,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    nil,
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo reject current bpkb beda",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":null,"max_overdue_last12months":null,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":null,"max_overdue_last12months":null,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":null,"max_overdue_last12months":null,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    nil,
				MaxOverdueLast12Months:        nil,
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo reject current bpkb beda",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":null,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":null,"max_overdue_last12months":0,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":null,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    nil,
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo reject current bpkb beda",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":null,"max_overdue_last12months":null,"angsuran_aktif_pbk":702009,"wo_contract":false,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":null,"max_overdue_last12months":null,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":null,"max_overdue_last12months":null,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    nil,
				MaxOverdueLast12Months:        nil,
				AngsuranAktifPbk:              float64(702009),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo pass ro bpkb beda ada wo agunan",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":true,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) & Ada Fasilitas WO Agunan",
				CustomerStatus:    "RO",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(45),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				WoAdaAgunan:                   true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo reject current bpkb beda baki debet <=3jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":true,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 3,
			"max_overdue_ko_rules": 40,
			"max_overdue_last12months_ko_rules": 70},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":70,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9107",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA BEDA (III) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				WoAdaAgunan:                   true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(3),
				MaxOverdueKORules:             float64(40),
				MaxOverdueLast12MonthsKORules: float64(70),
			},
		},
		{
			name:           "test pefindo reject current bpkb beda baki debet 3-20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":true,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 3,
			"max_overdue_ko_rules": 40,
			"max_overdue_last12months_ko_rules": 70},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":70,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9107",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA BEDA (III) " + constant.WORDING_BAKIDEBET_HIGHERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				WoAdaAgunan:                   true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(3),
				MaxOverdueKORules:             float64(40),
				MaxOverdueLast12MonthsKORules: float64(70),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo reject current bpkb beda baki debet >20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":true,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 3,
			"max_overdue_ko_rules": 40,
			"max_overdue_last12months_ko_rules": 70},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":70,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9107",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA BEDA (III) & Baki Debet > 20 Juta",
				CustomerStatus:    "RO",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(21000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				WoAdaAgunan:                   true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(3),
				MaxOverdueKORules:             float64(40),
				MaxOverdueLast12MonthsKORules: float64(70),
				TotalBakiDebetNonAgunan:       float64(21000000),
			},
		},
		{
			name:           "test pefindo reject current bpkb beda",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":true,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) & Ada Fasilitas WO Agunan",
				CustomerStatus:    "NEW",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(45),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				WoAdaAgunan:                   true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo reject current bpkb beda",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":true,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) & Baki Debet > 20 Juta",
				CustomerStatus:    "NEW",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(21000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(45),
				AngsuranAktifPbk:              float64(702009),
				TotalBakiDebetNonAgunan:       float64(21000000),
				WoContract:                    true,
				WoAdaAgunan:                   true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo pass exlcude bnpl bpkb beda ada wo agunan",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":true,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) & Ada Fasilitas WO Agunan",
				CustomerStatus:    "NEW",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(45),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				WoAdaAgunan:                   true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo pass exclude bnpl bpkb beda baki debet > 20jt",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":true,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) & Baki Debet > 20 Juta",
				CustomerStatus:    "NEW",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(21000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(45),
				AngsuranAktifPbk:              float64(702009),
				TotalBakiDebetNonAgunan:       float64(21000000),
				WoContract:                    true,
				WoAdaAgunan:                   true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo reject current bpkb sama baki debet <=3jt",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "NEW",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(45),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo reject current bpkb sama baki debet 3-20jt",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) " + constant.WORDING_BAKIDEBET_HIGHERTHAN_THRESHOLD,
				CustomerStatus:    "NEW",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(45),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo reject current bpkb sama baki debet >20jt",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) & Baki Debet > 20 Juta",
				CustomerStatus:    "NEW",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(21000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(45),
				AngsuranAktifPbk:              float64(702009),
				TotalBakiDebetNonAgunan:       float64(21000000),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo reject current bpkb sama ao/ro baki debet <=3jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(45),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo reject current bpkb sama ao/ro baki debet 3-20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) " + constant.WORDING_BAKIDEBET_HIGHERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(45),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo reject current bpkb sama ao/ro baki debet >20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "K",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   1,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9103",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA SAMA (I) & Baki Debet > 20 Juta",
				CustomerStatus:    "RO",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(21000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(45),
				AngsuranAktifPbk:              float64(702009),
				TotalBakiDebetNonAgunan:       float64(21000000),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo pass bpkb beda new baki debet <3jt",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "NEW",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo pass bpkb beda new baki debet 3-20jt",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) " + constant.WORDING_BAKIDEBET_HIGHERTHAN_THRESHOLD,
				CustomerStatus:    "NEW",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo pass bpkb beda new baki debet >20jt",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) & Baki Debet > 20 Juta",
				CustomerStatus:    "NEW",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(21000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(21000000),
			},
		},
		{
			name:           "test pefindo reject bpkb beda new",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 40,
			"max_overdue_last12months_ko_rules": 70},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9107",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA BEDA (I) & Tidak Ada Fasilitas WO Agunan",
				CustomerStatus:    "NEW",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(40),
				MaxOverdueLast12MonthsKORules: float64(70),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo pass bpkb beda ao/ro baki debet <3jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) " + constant.WORDING_BAKIDEBET_LOWERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo pass bpkb beda ao/ro baki debet 3-20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":18000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) " + constant.WORDING_BAKIDEBET_HIGHERTHAN_THRESHOLD,
				CustomerStatus:    "RO",
				NextProcess:       true,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(18000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(18000000),
			},
		},
		{
			name:           "test pefindo pass bpkb beda ao/ro baki debet >20jt",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_PASS,
				Reason:            "NAMA BEDA (I) & Baki Debet > 20 Juta",
				CustomerStatus:    "RO",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(21000000),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(0),
				MaxOverdueLast12Months:        float64(0),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				TotalBakiDebetNonAgunan:       float64(21000000),
			},
		},
		{
			name:           "test pefindo ovd include all reject bpkb beda",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL02400020230727001",
				Code:              "9096",
				Decision:          constant.DECISION_REJECT,
				Reason:            "NAMA BEDA & OVD Tidak sesuai ketentuan",
				CustomerStatus:    "NEW",
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				TotalBakiDebet:    float64(0),
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(45),
				AngsuranAktifPbk:              float64(702009),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo reject current bpkb beda",
			customerStatus: constant.STATUS_KONSUMEN_RO,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"201","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "AO/RO",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:     "SAL02400020230727001",
				Code:           "9190",
				Decision:       constant.DECISION_PASS,
				Reason:         "PBK Tidak Ditemukan - RO",
				CustomerStatus: "RO",
				NextProcess:    true,
				Cluster:        "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(45),
				AngsuranAktifPbk:              float64(702009),
				TotalBakiDebetNonAgunan:       float64(21000000),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo reject current bpkb beda",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"201","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:     "SAL02400020230727001",
				Code:           "9192",
				Decision:       constant.DECISION_PASS,
				Reason:         "PBK Tidak Ditemukan - NEW",
				CustomerStatus: "NEW",
				NextProcess:    true,
				Cluster:        "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64bb79a65a904",
				PefindoID:                     "6108521441",
				Score:                         "AVERAGE RISK",
				MaxOverdue:                    float64(40),
				MaxOverdueLast12Months:        float64(45),
				AngsuranAktifPbk:              float64(702009),
				TotalBakiDebetNonAgunan:       float64(21000000),
				WoContract:                    true,
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
			},
		},
		{
			name:           "test pefindo reject current bpkb beda",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL02400020230727001",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3275066006789999",
				LegalName:               "EMI LegalName",
				BirthDate:               "1971-04-15",
				Gender:                  "M",
				SurgateMotherName:       "HAROEMI MotherName",
				SpouseIDNumber:          "3345270510910123",
				SpouseLegalName:         "DIANA LegalName",
				SpouseBirthDate:         "1995-08-28",
				SpouseGender:            "F",
				SpouseSurgateMotherName: "ELSA",
				MaritalStatus:           "M",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"202","status":"SUCCESS",
			"result":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":702009,"wo_contract":true,"wo_ada_agunan":false,
			"total_baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
			"category": 1,
			"max_overdue_ko_rules": 0,
			"max_overdue_last12months_ko_rules": 0},
			"konsumen":{"search_id":"kp_64bb79a65a904","pefindo_id":"6108521441","score":"AVERAGE RISK",
			"max_overdue":40,"max_overdue_last12months":45,"angsuran_aktif_pbk":0,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":21000000,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf"},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK",
			"max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0,
			"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"},
			"server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:     "SAL02400020230727001",
				Code:           "9195",
				Reason:         "No Hit PBK",
				CustomerStatus: "NEW",
				Decision:       constant.DECISION_PASS,
				NextProcess:    true,
				Cluster:        "Cluster B",
			},
		},
		{
			name:           "test pefindo reject new ko rules lunas_diskon",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL-1140025011599999",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3578102808920028",
				LegalName:               "JOHN DOE",
				BirthDate:               "1992-08-28",
				Gender:                  "M",
				SurgateMotherName:       "UMI KALSUM",
				SpouseIDNumber:          "",
				SpouseLegalName:         "",
				SpouseBirthDate:         "",
				SpouseGender:            "",
				SpouseSurgateMotherName: "",
				MaritalStatus:           "S",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64d353aa22b0d","pefindo_id":"3944755342","score":"VERY HIGH RISK","max_overdue":21,"max_overdue_last12months":53,"angsuran_aktif_pbk":20392807,"wo_contract":false,"wo_ada_agunan":false,"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
				"max_overdue_ko_rules":0,
				"max_overdue_last12months_ko_rules":0,
				"category":1,
				"new_ko_rules":
					{
						"category_pbk":"lunas_diskon",
						"contract_code":"1004353027420098654345250",
						"contract_status":"SoldToThirdParty",
						"creditor_type":"NonBanks",
						"creditor":"Indonesia",
						"condition_date":"2024-08-01",
						"restructuring_date":"2024-08-01"
					}
				},
			"konsumen":{"search_id":"kp_64d353aa22b0d","pefindo_id":"3944755342","score":"VERY HIGH RISK","max_overdue":21,"max_overdue_last12months":53,"angsuran_aktif_pbk":20392807,"wo_contract":0,"wo_ada_agunan":0,"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
				"new_ko_rules":
					{
						"category_pbk":"lunas_diskon",
						"contract_code":"1004353027420098654345250",
						"contract_status":"SoldToThirdParty",
						"creditor_type":"NonBanks",
						"creditor":"Indonesia",
						"condition_date":"2024-08-01",
						"restructuring_date":"2024-08-01"
					}
				},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK", "max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0, "baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"}, "server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL-1140025011599999",
				Code:              constant.CODE_REJECT_LUNAS_DISKON,
				Reason:            constant.REASON_LUNAS_DISKON,
				CustomerStatus:    "NEW",
				Decision:          constant.DECISION_REJECT,
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64d353aa22b0d",
				PefindoID:                     "3944755342",
				Score:                         "VERY HIGH RISK",
				MaxOverdue:                    float64(21),
				MaxOverdueLast12Months:        float64(53),
				AngsuranAktifPbk:              float64(20392807),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				NewKoRules: response.ResultNewKoRules{
					CategoryPBK:       "lunas_diskon",
					ContractCode:      "1004353027420098654345250",
					ContractStatus:    "SoldToThirdParty",
					CreditorType:      "NonBanks",
					Creditor:          "Indonesia",
					ConditionDate:     "2024-08-01",
					RestructuringDate: "2024-08-01",
				},
			},
		},
		{
			name:           "test pefindo reject new ko rules fasilitas_dialihkan_dijual",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL-1140025011599999",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3578102808920028",
				LegalName:               "JOHN DOE",
				BirthDate:               "1992-08-28",
				Gender:                  "M",
				SurgateMotherName:       "UMI KALSUM",
				SpouseIDNumber:          "",
				SpouseLegalName:         "",
				SpouseBirthDate:         "",
				SpouseGender:            "",
				SpouseSurgateMotherName: "",
				MaritalStatus:           "S",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64d353aa22b0d","pefindo_id":"3944755342","score":"VERY HIGH RISK","max_overdue":21,"max_overdue_last12months":53,"angsuran_aktif_pbk":20392807,"wo_contract":false,"wo_ada_agunan":false,"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
				"max_overdue_ko_rules":0,
				"max_overdue_last12months_ko_rules":0,
				"category":1,
				"new_ko_rules":
					{
						"category_pbk":"fasilitas_dialihkan_dijual",
						"contract_code":"1004353027420098654345250",
						"contract_status":"SoldToThirdParty",
						"creditor_type":"NonBanks",
						"creditor":"Indonesia",
						"condition_date":"2024-08-01",
						"restructuring_date":"2024-08-01"
					}
				},
			"konsumen":{"search_id":"kp_64d353aa22b0d","pefindo_id":"3944755342","score":"VERY HIGH RISK","max_overdue":21,"max_overdue_last12months":53,"angsuran_aktif_pbk":20392807,"wo_contract":0,"wo_ada_agunan":0,"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
				"new_ko_rules":
					{
						"category_pbk":"fasilitas_dialihkan_dijual",
						"contract_code":"1004353027420098654345250",
						"contract_status":"SoldToThirdParty",
						"creditor_type":"NonBanks",
						"creditor":"Indonesia",
						"condition_date":"2024-08-01",
						"restructuring_date":"2024-08-01"
					}
				},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK", "max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0, "baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"}, "server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL-1140025011599999",
				Code:              constant.CODE_REJECT_FASILITAS_DIALIHKAN_DIJUAL,
				Reason:            constant.REASON_FASILITAS_DIALIHKAN_DIJUAL,
				CustomerStatus:    "NEW",
				Decision:          constant.DECISION_REJECT,
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64d353aa22b0d",
				PefindoID:                     "3944755342",
				Score:                         "VERY HIGH RISK",
				MaxOverdue:                    float64(21),
				MaxOverdueLast12Months:        float64(53),
				AngsuranAktifPbk:              float64(20392807),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				NewKoRules: response.ResultNewKoRules{
					CategoryPBK:       "fasilitas_dialihkan_dijual",
					ContractCode:      "1004353027420098654345250",
					ContractStatus:    "SoldToThirdParty",
					CreditorType:      "NonBanks",
					Creditor:          "Indonesia",
					ConditionDate:     "2024-08-01",
					RestructuringDate: "2024-08-01",
				},
			},
		},
		{
			name:           "test pefindo reject new ko rules hapus_tagih",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL-1140025011599999",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3578102808920028",
				LegalName:               "JOHN DOE",
				BirthDate:               "1992-08-28",
				Gender:                  "M",
				SurgateMotherName:       "UMI KALSUM",
				SpouseIDNumber:          "",
				SpouseLegalName:         "",
				SpouseBirthDate:         "",
				SpouseGender:            "",
				SpouseSurgateMotherName: "",
				MaritalStatus:           "S",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64d353aa22b0d","pefindo_id":"3944755342","score":"VERY HIGH RISK","max_overdue":21,"max_overdue_last12months":53,"angsuran_aktif_pbk":20392807,"wo_contract":false,"wo_ada_agunan":false,"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
				"max_overdue_ko_rules":0,
				"max_overdue_last12months_ko_rules":0,
				"category":1,
				"new_ko_rules":
					{
						"category_pbk":"hapus_tagih",
						"contract_code":"1004353027420098654345250",
						"contract_status":"SoldToThirdParty",
						"creditor_type":"NonBanks",
						"creditor":"Indonesia",
						"condition_date":"2024-08-01",
						"restructuring_date":"2024-08-01"
					}
				},
			"konsumen":{"search_id":"kp_64d353aa22b0d","pefindo_id":"3944755342","score":"VERY HIGH RISK","max_overdue":21,"max_overdue_last12months":53,"angsuran_aktif_pbk":20392807,"wo_contract":0,"wo_ada_agunan":0,"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
				"new_ko_rules":
					{
						"category_pbk":"hapus_tagih",
						"contract_code":"1004353027420098654345250",
						"contract_status":"SoldToThirdParty",
						"creditor_type":"NonBanks",
						"creditor":"Indonesia",
						"condition_date":"2024-08-01",
						"restructuring_date":"2024-08-01"
					}
				},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK", "max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0, "baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"}, "server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL-1140025011599999",
				Code:              constant.CODE_REJECT_HAPUS_TAGIH,
				Reason:            constant.REASON_HAPUS_TAGIH,
				CustomerStatus:    "NEW",
				Decision:          constant.DECISION_REJECT,
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64d353aa22b0d",
				PefindoID:                     "3944755342",
				Score:                         "VERY HIGH RISK",
				MaxOverdue:                    float64(21),
				MaxOverdueLast12Months:        float64(53),
				AngsuranAktifPbk:              float64(20392807),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				NewKoRules: response.ResultNewKoRules{
					CategoryPBK:       "hapus_tagih",
					ContractCode:      "1004353027420098654345250",
					ContractStatus:    "SoldToThirdParty",
					CreditorType:      "NonBanks",
					Creditor:          "Indonesia",
					ConditionDate:     "2024-08-01",
					RestructuringDate: "2024-08-01",
				},
			},
		},
		{
			name:           "test pefindo reject new ko rules repossess",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL-1140025011599999",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3578102808920028",
				LegalName:               "JOHN DOE",
				BirthDate:               "1992-08-28",
				Gender:                  "M",
				SurgateMotherName:       "UMI KALSUM",
				SpouseIDNumber:          "",
				SpouseLegalName:         "",
				SpouseBirthDate:         "",
				SpouseGender:            "",
				SpouseSurgateMotherName: "",
				MaritalStatus:           "S",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64d353aa22b0d","pefindo_id":"3944755342","score":"VERY HIGH RISK","max_overdue":21,"max_overdue_last12months":53,"angsuran_aktif_pbk":20392807,"wo_contract":false,"wo_ada_agunan":false,"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
				"max_overdue_ko_rules":0,
				"max_overdue_last12months_ko_rules":0,
				"category":1,
				"new_ko_rules":
					{
						"category_pbk":"repossess",
						"contract_code":"1004353027420098654345250",
						"contract_status":"SoldToThirdParty",
						"creditor_type":"NonBanks",
						"creditor":"Indonesia",
						"condition_date":"2024-08-01",
						"restructuring_date":"2024-08-01"
					}
				},
			"konsumen":{"search_id":"kp_64d353aa22b0d","pefindo_id":"3944755342","score":"VERY HIGH RISK","max_overdue":21,"max_overdue_last12months":53,"angsuran_aktif_pbk":20392807,"wo_contract":0,"wo_ada_agunan":0,"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
				"new_ko_rules":
					{
						"category_pbk":"repossess",
						"contract_code":"1004353027420098654345250",
						"contract_status":"SoldToThirdParty",
						"creditor_type":"NonBanks",
						"creditor":"Indonesia",
						"condition_date":"2024-08-01",
						"restructuring_date":"2024-08-01"
					}
				},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK", "max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0, "baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"}, "server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL-1140025011599999",
				Code:              constant.CODE_REJECT_REPOSSES,
				Reason:            constant.REASON_REPOSSES,
				CustomerStatus:    "NEW",
				Decision:          constant.DECISION_REJECT,
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64d353aa22b0d",
				PefindoID:                     "3944755342",
				Score:                         "VERY HIGH RISK",
				MaxOverdue:                    float64(21),
				MaxOverdueLast12Months:        float64(53),
				AngsuranAktifPbk:              float64(20392807),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				NewKoRules: response.ResultNewKoRules{
					CategoryPBK:       "repossess",
					ContractCode:      "1004353027420098654345250",
					ContractStatus:    "SoldToThirdParty",
					CreditorType:      "NonBanks",
					Creditor:          "Indonesia",
					ConditionDate:     "2024-08-01",
					RestructuringDate: "2024-08-01",
				},
			},
		},
		{
			name:           "test pefindo reject new ko rules restructure",
			customerStatus: constant.STATUS_KONSUMEN_NEW,
			clusterCMO:     constant.CLUSTER_C,
			reqPefindo: request.Pefindo{
				ClientKey:               os.Getenv("CLIENTKEY_CORE_PBK"),
				IDMember:                constant.USER_PBK_KMB_FILTEERING,
				User:                    constant.USER_PBK_KMB_FILTEERING,
				ProspectID:              "SAL-1140025011599999",
				BPKBName:                "KK",
				BranchID:                "426",
				IDNumber:                "3578102808920028",
				LegalName:               "JOHN DOE",
				BirthDate:               "1992-08-28",
				Gender:                  "M",
				SurgateMotherName:       "UMI KALSUM",
				SpouseIDNumber:          "",
				SpouseLegalName:         "",
				SpouseBirthDate:         "",
				SpouseGender:            "",
				SpouseSurgateMotherName: "",
				MaritalStatus:           "S",
			},
			rPefindoCode: 200,
			rPefindoBody: `{"code":"200","status":"SUCCESS",
			"result":{"search_id":"kp_64d353aa22b0d","pefindo_id":"3944755342","score":"VERY HIGH RISK","max_overdue":21,"max_overdue_last12months":53,"angsuran_aktif_pbk":20392807,"wo_contract":false,"wo_ada_agunan":false,"total_baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
				"max_overdue_ko_rules":0,
				"max_overdue_last12months_ko_rules":0,
				"category":1,
				"new_ko_rules":
					{
						"category_pbk":"restructure",
						"contract_code":"1004353027420098654345250",
						"contract_status":"SoldToThirdParty",
						"creditor_type":"NonBanks",
						"creditor":"Indonesia",
						"condition_date":"2024-08-01",
						"restructuring_date":"2024-08-01"
					}
				},
			"konsumen":{"search_id":"kp_64d353aa22b0d","pefindo_id":"3944755342","score":"VERY HIGH RISK","max_overdue":21,"max_overdue_last12months":53,"angsuran_aktif_pbk":20392807,"wo_contract":0,"wo_ada_agunan":0,"baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79a65a904_6108521441.pdf",
				"new_ko_rules":
					{
						"category_pbk":"restructure",
						"contract_code":"1004353027420098654345250",
						"contract_status":"SoldToThirdParty",
						"creditor_type":"NonBanks",
						"creditor":"Indonesia",
						"condition_date":"2024-08-01",
						"restructuring_date":"2024-08-01"
					}
				},
			"pasangan":{"search_id":"kp_64bb79ab36b6d","pefindo_id":"5793480682","score":"AVERAGE RISK", "max_overdue":0,"max_overdue_last12months":0,"angsuran_aktif_pbk":702009,"wo_contract":0,"wo_ada_agunan":0, "baki_debet_non_agunan":0,"detail_report":"http:\/\/10.0.0.170\/los-symlink\/pefindo\/pdf\/pdf_kp_64bb79ab36b6d_5793480682.pdf"}, "server_time":"2023-07-22T13:39:45+07:00","duration_time":"11000 ms"}`,
			reqMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
			},
			resMappingCluster: entity.MasterMappingCluster{
				BranchID:       "426",
				CustomerStatus: "NEW",
				BpkbNameType:   0,
				Cluster:        "Cluster B",
			},
			respFilteringPefindo: response.Filtering{
				ProspectID:        "SAL-1140025011599999",
				Code:              constant.CODE_REJECT_RESTRUCTURE,
				Reason:            constant.REASON_RESTRUCTURE,
				CustomerStatus:    "NEW",
				Decision:          constant.DECISION_REJECT,
				NextProcess:       false,
				PbkReportCustomer: &pbkCustomer,
				PbkReportSpouse:   &pbkSpouse,
				Cluster:           "Cluster B",
			},
			resPefindo: response.PefindoResult{
				SearchID:                      "kp_64d353aa22b0d",
				PefindoID:                     "3944755342",
				Score:                         "VERY HIGH RISK",
				MaxOverdue:                    float64(21),
				MaxOverdueLast12Months:        float64(53),
				AngsuranAktifPbk:              float64(20392807),
				DetailReport:                  "http://10.0.0.170/los-symlink/pefindo/pdf/pdf_kp_64bb79a65a904_6108521441.pdf",
				Category:                      float64(1),
				MaxOverdueKORules:             float64(0),
				MaxOverdueLast12MonthsKORules: float64(0),
				NewKoRules: response.ResultNewKoRules{
					CategoryPBK:       "restructure",
					ContractCode:      "1004353027420098654345250",
					ContractStatus:    "SoldToThirdParty",
					CreditorType:      "NonBanks",
					Creditor:          "Indonesia",
					ConditionDate:     "2024-08-01",
					RestructuringDate: "2024-08-01",
				},
			},
		},
	}
	for _, tc := range testcases {
		t.Run(tc.name, func(t *testing.T) {
			mockRepository := new(mocks.Repository)
			mockHttpClient := new(httpclient.MockHttpClient)

			mockRepository.On("MasterMappingCluster", tc.reqMappingCluster).Return(tc.resMappingCluster, tc.errMappingCluster)

			rst := resty.New()
			httpmock.ActivateNonDefault(rst.GetClient())
			defer httpmock.DeactivateAndReset()

			httpmock.RegisterResponder(constant.METHOD_POST, os.Getenv("NEW_KMB_PBK_URL"), httpmock.NewStringResponder(tc.rPefindoCode, tc.rPefindoBody))
			resp, _ := rst.R().Post(os.Getenv("NEW_KMB_PBK_URL"))

			param, _ := json.Marshal(tc.reqPefindo)
			mockHttpClient.On("EngineAPI", ctx, constant.NEW_KMB_LOG, os.Getenv("NEW_KMB_PBK_URL"), param, map[string]string{}, constant.METHOD_POST, false, 0, timeOut, tc.reqPefindo.ProspectID, accessToken).Return(resp, tc.errPefindo).Once()
			usecase := NewUsecase(mockRepository, mockHttpClient)

			rFilteringPefindo, rPefindo, _, err := usecase.FilteringPefindo(ctx, tc.reqPefindo, tc.customerStatus, tc.clusterCMO, tc.isPrimePriority, accessToken)
			require.Equal(t, tc.respFilteringPefindo, rFilteringPefindo)
			require.Equal(t, tc.resPefindo, rPefindo)
			require.Equal(t, tc.errFinal, err)
		})
	}
}

func TestDupcheckIntegrator(t *testing.T) {
	timeout, _ := strconv.Atoi(os.Getenv("DEFAULT_TIMEOUT_30S"))
	accessToken := "token"
	ctx := context.Background()
	reqID := utils.GenerateUUID()
	ctx = context.WithValue(ctx, constant.HeaderXRequestID, reqID)

	ProspectID := "SAL02400020230727001"
	IDNumber := "3275066006789999"
	LegalName := "EMI LegalName"
	BirthDate := "1971-04-15"
	MotherName := "HAROEMI MotherName"

	testcases := []struct {
		name          string
		rDupcheckCode int
		rDupcheckBody string
		errHttp       error
		resDupcheck   response.SpDupCekCustomerByID
		errFinal      error
	}{
		{
			name:     "test error",
			errHttp:  errors.New("upstream_service_timeout - Call Dupcheck Timeout"),
			errFinal: errors.New("upstream_service_timeout - Call Dupcheck Timeout"),
		},
		{
			name:          "test error > 200",
			rDupcheckCode: 400,
			errFinal:      errors.New("upstream_service_error - Call Dupcheck Error"),
		},
		{
			name:          "test success",
			rDupcheckCode: 200,
			rDupcheckBody: `{ "messages": "LOS DUPCHECK", "errors": null, 
			"data": { "customer_id": null, "id_number": "", "full_name": "", "birth_date": "", "surgate_mother_name": "", "birth_place": "", "gender": "", 
			"emergency_contact_address": "", "legal_address": "", "legal_kelurahan": "", "legal_kecamatan": "", "legal_city": "", "lagal_zipcode": "", 
			"residence_address": "", "residence_kelurahan": "", "residence_kecamatan": "", "residence_city": "", "residence_zipcode": "", "company_address": "", 
			"company_kelurahan": "", "company_kecamatan": "", "company_city": "", "company_zipcode": "", "personal_npwp": "", "education": "", "marital_status": "", 
			"num_of_dependence": 0, "home_status": "", "profession_id": "", "job_type_id": "", "job_pos": null, "monthly_fixed_income": 0, "spouse_income": null, 
			"monthly_variable_income": 0, "total_installment": 0, "total_installment_nap": 0, "bad_type": null, "max_overduedays": 0, "max_overduedays_roao": null, 
			"num_of_asset_inventoried": 0, "overduedays_aging": null, "max_overduedays_for_active_agreement": null, "max_overduedays_for_prev_eom": null, 
			"sisa_jumlah_angsuran": null, "rrd_date": null, "number_of_agreement": 0, "work_since_year": null, "outstanding_principal": 0, "os_installmentdue": 0, 
			"is_restructure": 0, "is_similiar": 0, "customer_status": "", "customer_segment": "" }, "server_time": "2023-08-07T08:28:13+07:00", "request_id": "" }`,
		},
	}
	for _, tc := range testcases {
		t.Run(tc.name, func(t *testing.T) {
			mockRepository := new(mocks.Repository)
			mockHttpClient := new(httpclient.MockHttpClient)

			rst := resty.New()
			httpmock.ActivateNonDefault(rst.GetClient())
			defer httpmock.DeactivateAndReset()

			httpmock.RegisterResponder(constant.METHOD_POST, os.Getenv("NEW_KMB_DUPCHECK_URL"), httpmock.NewStringResponder(tc.rDupcheckCode, tc.rDupcheckBody))
			resp, _ := rst.R().Post(os.Getenv("NEW_KMB_DUPCHECK_URL"))

			mockHttpClient.On("EngineAPI", ctx, constant.NEW_KMB_LOG, os.Getenv("NEW_KMB_DUPCHECK_URL"), mock.Anything, map[string]string{}, constant.METHOD_POST, false, 0, timeout, ProspectID, accessToken).Return(resp, tc.errHttp).Once()
			usecase := NewUsecase(mockRepository, mockHttpClient)

			result, err := usecase.DupcheckIntegrator(ctx, ProspectID, IDNumber, LegalName, BirthDate, MotherName, accessToken)
			require.Equal(t, tc.resDupcheck, result)
			require.Equal(t, tc.errFinal, err)
		})
	}
}

func TestGetResultFiltering(t *testing.T) {
	testcases := []struct {
		name                  string
		prospectID            string
		getResultFiltering    []entity.ResultFiltering
		errgetResultFiltering error
		errFinal              error
		respFiltering         response.Filtering
	}{
		{
			name:       "test_get_result_filtering_err",
			prospectID: "SAL-1234567890",
			errFinal:   errors.New(constant.ERROR_UPSTREAM + " - Get Result Filtering Error"),
		},
		{
			name:       "test_get_result_filtering_success",
			prospectID: "SAL-1234567890",
			getResultFiltering: []entity.ResultFiltering{
				{
					ProspectID:                      "SAL-1234567890",
					TotalBakiDebetNonCollateralBiro: 100000,
					Subject:                         "CUSTOMER",
					UrlPdfReport:                    "http://urlpdf.com/customer.pdf",
				},
				{
					ProspectID:                      "SAL-1234567890",
					TotalBakiDebetNonCollateralBiro: 100000,
					Subject:                         "SPOUSE",
					UrlPdfReport:                    "http://urlpdf.com/spouse.pdf",
				},
			},
			respFiltering: response.Filtering{
				ProspectID:        "SAL-1234567890",
				TotalBakiDebet:    float64(100000),
				PbkReportCustomer: "http://urlpdf.com/customer.pdf",
				PbkReportSpouse:   "http://urlpdf.com/spouse.pdf",
			},
		},
		{
			name:       "test_get_result_filtering_err_conv_float",
			prospectID: "SAL-1234567890",
			getResultFiltering: []entity.ResultFiltering{
				{
					ProspectID:                      "SAL-1234567890",
					TotalBakiDebetNonCollateralBiro: "abcd",
					Subject:                         "CUSTOMER",
					UrlPdfReport:                    "http://urlpdf.com/customer.pdf",
				},
			},
			respFiltering: response.Filtering{
				ProspectID: "SAL-1234567890",
			},
			errFinal: errors.New(constant.ERROR_UPSTREAM + " - GetResultFiltering GetFloat Error"),
		},
	}

	for _, tc := range testcases {
		t.Run(tc.name, func(t *testing.T) {
			mockRepository := new(mocks.Repository)
			mockHttpClient := new(httpclient.MockHttpClient)

			mockRepository.On("GetResultFiltering", tc.prospectID).Return(tc.getResultFiltering, tc.errgetResultFiltering)

			usecase := NewUsecase(mockRepository, mockHttpClient)

			result, err := usecase.GetResultFiltering(tc.prospectID)
			require.Equal(t, tc.respFiltering, result)
			require.Equal(t, tc.errFinal, err)
		})
	}
}

func TestGetEmployeeData(t *testing.T) {
	timeout, _ := strconv.Atoi(os.Getenv("DEFAULT_TIMEOUT_30S"))
	accessToken := "token"
	hrisAccessToken := "hris-access-token"

	testCases := []struct {
		name            string
		employeeID      string
		accessToken     string
		hrisAccessToken string
		mockResponse    response.GetEmployeeByID
		mockStatusCode  int
		mockError       error
		expectedError   error
		expectedData    response.EmployeeCMOResponse
	}{
		{
			name:            "Success - Active CMO",
			employeeID:      "G010441066",
			accessToken:     "access-token",
			hrisAccessToken: "hris-access-token",
			mockResponse: response.GetEmployeeByID{
				Data: []response.EmployeeCareerHistory{
					{
						EmployeeID:        "G010441066",
						EmployeeName:      "John Doe",
						PositionGroupCode: "AO",
						PositionGroupName: "Credit Marketing Officer",
						RealCareerDate:    "2022-01-01T00:00:00",
					},
				},
			},
			mockStatusCode: 200,
			expectedError:  nil,
			expectedData: response.EmployeeCMOResponse{
				EmployeeID:         "G010441066",
				EmployeeName:       "John Doe",
				EmployeeIDWithName: "G010441066 - John Doe",
				JoinDate:           "2022-01-01",
				PositionGroupCode:  "AO",
				PositionGroupName:  "Credit Marketing Officer",
				CMOCategory:        constant.CMO_LAMA,
				IsCmoSpv:           false,
			},
		},
		{
			name:            "Stop Process - hit use NIK as AO SPV but resp HRIS as CMO",
			employeeID:      "G010441066MO",
			accessToken:     "access-token",
			hrisAccessToken: "hris-access-token",
			mockResponse: response.GetEmployeeByID{
				Data: []response.EmployeeCareerHistory{
					{
						EmployeeID:        "G010441066",
						EmployeeName:      "John Doe",
						PositionGroupCode: "AO",
						PositionGroupName: "Credit Marketing Officer",
						RealCareerDate:    "2022-01-01T00:00:00",
					},
				},
			},
			mockStatusCode: 200,
			expectedError:  nil,
			expectedData: response.EmployeeCMOResponse{
				EmployeeID:         "",
				EmployeeName:       "",
				EmployeeIDWithName: "",
				JoinDate:           "",
				PositionGroupCode:  "",
				PositionGroupName:  "",
				CMOCategory:        "",
				IsCmoSpv:           nil,
			},
		},
		{
			name:            "Stop Process - hit use NIK as CMO but resp HRIS as AOSPV",
			employeeID:      "G010441066",
			accessToken:     "access-token",
			hrisAccessToken: "hris-access-token",
			mockResponse: response.GetEmployeeByID{
				Data: []response.EmployeeCareerHistory{
					{
						EmployeeID:        "G010441066",
						EmployeeName:      "John Doe",
						PositionGroupCode: "AOSPV",
						PositionGroupName: "SPV CMO",
						RealCareerDate:    "2022-01-01T00:00:00",
					},
				},
			},
			mockStatusCode: 200,
			expectedError:  nil,
			expectedData: response.EmployeeCMOResponse{
				EmployeeID:         "",
				EmployeeName:       "",
				EmployeeIDWithName: "",
				JoinDate:           "",
				PositionGroupCode:  "",
				PositionGroupName:  "",
				CMOCategory:        "",
				IsCmoSpv:           nil,
			},
		},
		{
			name:            "Success - CMO Resign",
			employeeID:      "123",
			accessToken:     "access-token",
			hrisAccessToken: "hris-access-token",
			mockResponse: response.GetEmployeeByID{
				Data: []response.EmployeeCareerHistory{
					{
						EmployeeID:        "123",
						EmployeeName:      "John Doe",
						PositionGroupCode: "AO",
						PositionGroupName: "Credit Marketing Officer",
						RealCareerDate:    "2022-01-01T00:00:00",
						IsResign:          true,
					},
				},
			},
			mockStatusCode: 200,
			expectedError:  nil,
			expectedData: response.EmployeeCMOResponse{
				EmployeeID:         "",
				EmployeeName:       "",
				EmployeeIDWithName: "",
				JoinDate:           "",
				PositionGroupCode:  "",
				PositionGroupName:  "",
				CMOCategory:        "",
				IsCmoSpv:           nil,
			},
		},
		{
			name:            "Success - SPV as CMO NIK MO",
			employeeID:      "123MO",
			accessToken:     "access-token",
			hrisAccessToken: "hris-access-token",
			mockResponse: response.GetEmployeeByID{
				Data: []response.EmployeeCareerHistory{
					{
						EmployeeID:        "123",
						EmployeeName:      "John Doe",
						PositionGroupCode: "AOSPV",
						PositionGroupName: "SPV CMO",
						RealCareerDate:    "2022-01-01T00:00:00",
					},
				},
			},
			mockStatusCode: 200,
			expectedError:  nil,
			expectedData: response.EmployeeCMOResponse{
				EmployeeID:         "123",
				EmployeeName:       "John Doe",
				EmployeeIDWithName: "123 - John Doe",
				JoinDate:           "2022-01-01",
				PositionGroupCode:  "AOSPV",
				PositionGroupName:  "SPV CMO",
				CMOCategory:        "",
				IsCmoSpv:           true,
			},
		},
		{
			name:            "Success - SPV as CMO NIK INH",
			employeeID:      "123INH",
			accessToken:     "access-token",
			hrisAccessToken: "hris-access-token",
			mockResponse: response.GetEmployeeByID{
				Data: []response.EmployeeCareerHistory{
					{
						EmployeeID:        "123",
						EmployeeName:      "John Doe",
						PositionGroupCode: "AOSPV",
						PositionGroupName: "SPV CMO",
						RealCareerDate:    "2022-01-01T00:00:00",
					},
				},
			},
			mockStatusCode: 200,
			expectedError:  nil,
			expectedData: response.EmployeeCMOResponse{
				EmployeeID:         "123",
				EmployeeName:       "John Doe",
				EmployeeIDWithName: "123 - John Doe",
				JoinDate:           "2022-01-01",
				PositionGroupCode:  "AOSPV",
				PositionGroupName:  "SPV CMO",
				CMOCategory:        "",
				IsCmoSpv:           true,
			},
		},
		{
			name:            "Error - Employee Data Timeout",
			employeeID:      "123",
			accessToken:     "access-token",
			hrisAccessToken: "hris-access-token",
			mockResponse:    response.GetEmployeeByID{},
			mockStatusCode:  504,
			expectedError:   errors.New(constant.ERROR_UPSTREAM_TIMEOUT + " - Get Employee Data Timeout"),
			expectedData:    response.EmployeeCMOResponse{},
			mockError:       errors.New(constant.ERROR_UPSTREAM_TIMEOUT + " - Get Employee Data Timeout"),
		},
		{
			name:            "Error - Employee Data Not Found",
			employeeID:      "123",
			accessToken:     "access-token",
			hrisAccessToken: "hris-access-token",
			mockResponse:    response.GetEmployeeByID{},
			mockStatusCode:  404,
			expectedError:   errors.New(constant.ERROR_UPSTREAM + " - Get Employee Data Error"),
			expectedData:    response.EmployeeCMOResponse{},
			mockError:       errors.New(constant.ERROR_UPSTREAM + " - Get Employee Data Error"),
		},
		{
			name:            "Error - RealCareerDate Empty",
			employeeID:      "123",
			accessToken:     "access-token",
			hrisAccessToken: "hris-access-token",
			mockResponse: response.GetEmployeeByID{
				Data: []response.EmployeeCareerHistory{
					{
						EmployeeID:        "123",
						EmployeeName:      "John Doe",
						PositionGroupCode: "AO",
						RealCareerDate:    "",
					},
				},
			},
			mockStatusCode: 200,
			expectedError:  errors.New(constant.ERROR_BAD_REQUEST + " - Get Employee Data Error"),
			expectedData:   response.EmployeeCMOResponse{},
			mockError:      errors.New(constant.ERROR_BAD_REQUEST + " - Get Employee Data Error"),
		},
	}

	for _, tc := range testCases {
		t.Run(tc.name, func(t *testing.T) {
			mockRepository := new(mocks.Repository)
			mockHttpClient := new(httpclient.MockHttpClient)

			mockResponseBody, err := jsoniter.MarshalToString(tc.mockResponse)
			if err != nil {
				t.Fatalf("failed to marshal mock response: %v", err)
			}

			rst := resty.New()
			httpmock.ActivateNonDefault(rst.GetClient())
			defer httpmock.DeactivateAndReset()

			httpmock.RegisterResponder(constant.METHOD_POST, os.Getenv("HRIS_GET_EMPLOYEE_DATA_URL"), httpmock.NewStringResponder(tc.mockStatusCode, mockResponseBody))
			resp, _ := rst.R().Post(os.Getenv("HRIS_GET_EMPLOYEE_DATA_URL"))

			mockHttpClient.On("EngineAPI", mock.Anything, constant.NEW_KMB_LOG, os.Getenv("HRIS_GET_EMPLOYEE_DATA_URL"), mock.Anything, map[string]string{"Authorization": "Bearer hris-access-token"}, constant.METHOD_POST, false, 0, timeout, "", accessToken).Return(resp, tc.mockError).Once()

			usecase := NewUsecase(mockRepository, mockHttpClient)

			data, err := usecase.GetEmployeeData(context.Background(), tc.employeeID, accessToken, hrisAccessToken)

			require.Equal(t, tc.expectedError, err)
			require.Equal(t, tc.expectedData, data)
		})
	}
}

func TestGetFpdCMO(t *testing.T) {
	os.Setenv("AGREEMENT_LTV_FPD", "http://10.9.100.122:8181/api/v1/agreement/ltv-fpd")

	timeout, _ := strconv.Atoi(os.Getenv("DEFAULT_TIMEOUT_30S"))
	ctx := context.Background()
	reqID := utils.GenerateUUID()
	ctx = context.WithValue(ctx, constant.HeaderXRequestID, reqID)
	accessToken := "token"

	testCases := []struct {
		name           string
		cmoID          string
		bpkbNameType   string
		accessToken    string
		mockResponse   response.GetFPDCmoByID
		mockStatusCode int
		mockError      error
		expectedError  error
		expectedData   response.FpdCMOResponse
	}{
		{
			name:         "Success - FPD Data for NAMA BEDA",
			cmoID:        "CMO01",
			bpkbNameType: "NAMA BEDA",
			accessToken:  "access-token",
			mockResponse: response.GetFPDCmoByID{
				Data: []response.FpdData{
					{
						BpkbNameType: "NAMA BEDA",
						Fpd:          1.5,
						AccSales:     10,
					},
				},
			},
			mockStatusCode: 200,
			expectedError:  nil,
			expectedData: response.FpdCMOResponse{
				FpdExist:    true,
				CmoFpd:      1.5,
				CmoAccSales: 10,
			},
		},
		{
			name:         "Success - FPD Data for NAMA SAMA",
			cmoID:        "CMO02",
			bpkbNameType: "NAMA SAMA",
			accessToken:  "access-token",
			mockResponse: response.GetFPDCmoByID{
				Data: []response.FpdData{
					{
						BpkbNameType: "NAMA SAMA",
						Fpd:          2.0,
						AccSales:     15,
					},
				},
			},
			mockStatusCode: 200,
			expectedError:  nil,
			expectedData: response.FpdCMOResponse{
				FpdExist:    true,
				CmoFpd:      2.0,
				CmoAccSales: 15,
			},
		},
		{
			name:         "Success - FPD Data for NAMA BEDA and NAMA SAMA kosong",
			cmoID:        "CMO11",
			bpkbNameType: "NAMA BEDA",
			accessToken:  "access-token",
			mockResponse: response.GetFPDCmoByID{
				Data: []response.FpdData{},
			},
			mockStatusCode: 200,
			expectedError:  nil,
			expectedData: response.FpdCMOResponse{
				FpdExist:    false,
				CmoFpd:      0,
				CmoAccSales: 0,
			},
		},
		{
			name:         "Success - FPD Data for BPKB NAMA AGAK LAEN",
			cmoID:        "CMO12",
			bpkbNameType: "NAMA AGAK LAEN",
			accessToken:  "access-token",
			mockResponse: response.GetFPDCmoByID{
				Data: []response.FpdData{
					{
						BpkbNameType: "NAMA BEDA",
						Fpd:          1.5,
						AccSales:     10,
					},
					{
						BpkbNameType: "NAMA SAMA",
						Fpd:          2.0,
						AccSales:     15,
					},
				},
			},
			mockStatusCode: 200,
			expectedError:  nil,
			expectedData: response.FpdCMOResponse{
				FpdExist:    false,
				CmoFpd:      0,
				CmoAccSales: 0,
			},
		},
		{
			name:           "Error - FPD Data Timeout",
			cmoID:          "CMO03",
			bpkbNameType:   "NAMA BEDA",
			accessToken:    "access-token",
			mockResponse:   response.GetFPDCmoByID{},
			mockStatusCode: 504,
			expectedError:  errors.New(constant.ERROR_UPSTREAM_TIMEOUT + " - Get FPD Data Timeout"),
			expectedData:   response.FpdCMOResponse{},
			mockError:      errors.New(constant.ERROR_UPSTREAM_TIMEOUT + " - Get FPD Data Timeout"),
		},
		{
			name:           "Error - FPD Data Not Found",
			cmoID:          "CMO04",
			bpkbNameType:   "NAMA SAMA",
			accessToken:    "access-token",
			mockResponse:   response.GetFPDCmoByID{},
			mockStatusCode: 404,
			expectedError:  errors.New(constant.ERROR_UPSTREAM + " - Get FPD Data Error"),
			expectedData:   response.FpdCMOResponse{},
			mockError:      errors.New(constant.ERROR_UPSTREAM + " - Get FPD Data Error"),
		},
	}

	for _, tc := range testCases {
		t.Run(tc.name, func(t *testing.T) {
			mockRepository := new(mocks.Repository)
			mockHttpClient := new(httpclient.MockHttpClient)

			mockResponseBody, err := jsoniter.MarshalToString(tc.mockResponse)
			if err != nil {
				t.Fatalf("failed to marshal mock response: %v", err)
			}

			rst := resty.New()
			httpmock.ActivateNonDefault(rst.GetClient())
			defer httpmock.DeactivateAndReset()

			httpmock.RegisterResponder(constant.METHOD_GET, os.Getenv("AGREEMENT_LTV_FPD")+"?lob_id=2&cmo_id="+tc.cmoID, httpmock.NewStringResponder(tc.mockStatusCode, mockResponseBody))
			resp, _ := rst.R().SetHeaders(map[string]string{"Content-Type": "application/json", "Authorization": accessToken}).Get(os.Getenv("AGREEMENT_LTV_FPD") + "?lob_id=2&cmo_id=" + tc.cmoID)

			mockHttpClient.On("EngineAPI", ctx, constant.NEW_KMB_LOG, os.Getenv("AGREEMENT_LTV_FPD")+"?lob_id=2&cmo_id="+tc.cmoID, []byte(nil), map[string]string{"Authorization": accessToken}, constant.METHOD_GET, false, 0, timeout, "", accessToken).Return(resp, tc.mockError).Once()
			usecase := NewUsecase(mockRepository, mockHttpClient)

			data, err := usecase.GetFpdCMO(ctx, tc.cmoID, tc.bpkbNameType, accessToken)

			require.Equal(t, tc.expectedError, err)
			require.Equal(t, tc.expectedData, data)
		})
	}
}

func TestCheckCmoNoFPD(t *testing.T) {
	testcases := []struct {
		name               string
		prospectID         string
		cmoID              string
		cmoCategory        string
		cmoJoinDate        string
		defaultCluster     string
		bpkbName           string
		mockReturnData     entity.TrxCmoNoFPD
		mockReturnError    error
		expectedCluster    string
		expectedEntitySave entity.TrxCmoNoFPD
		expectedError      error
	}{
		{
			name:            "test new CMO",
			prospectID:      "SAL0002",
			cmoID:           "CMO02",
			cmoCategory:     constant.CMO_BARU,
			cmoJoinDate:     "2024-05-28",
			defaultCluster:  "Cluster C",
			bpkbName:        "NAMA BEDA",
			mockReturnData:  entity.TrxCmoNoFPD{},
			expectedCluster: "",
			expectedEntitySave: entity.TrxCmoNoFPD{
				ProspectID:              "SAL0002",
				BPKBName:                "NAMA BEDA",
				CMOID:                   "CMO02",
				CmoCategory:             constant.CMO_BARU,
				CmoJoinDate:             "2024-05-28",
				DefaultCluster:          "Cluster C",
				DefaultClusterStartDate: "2024-05-28",
				DefaultClusterEndDate:   "2024-04-30",
			},
			expectedError: nil,
		},
		{
			name:               "test error in repository",
			prospectID:         "SAL0003",
			cmoID:              "CMO03",
			cmoCategory:        constant.CMO_LAMA,
			cmoJoinDate:        "2023-01-01",
			defaultCluster:     "Cluster B",
			bpkbName:           "NAMA SAMA",
			mockReturnData:     entity.TrxCmoNoFPD{},
			mockReturnError:    errors.New("repository error"),
			expectedCluster:    "",
			expectedEntitySave: entity.TrxCmoNoFPD{},
			expectedError:      errors.New(constant.ERROR_UPSTREAM + " - Check CMO No FPD error"),
		},
		{
			name:           "test CMO within date range",
			prospectID:     "SAL0004",
			cmoID:          "CMO04",
			cmoCategory:    constant.CMO_BARU,
			cmoJoinDate:    "2024-06-01",
			defaultCluster: "Cluster A",
			bpkbName:       "NAMA CMO",
			mockReturnData: entity.TrxCmoNoFPD{
				ProspectID:              "SAL0004",
				BPKBName:                "NAMA CMO",
				CMOID:                   "CMO04",
				CmoCategory:             constant.CMO_BARU,
				CmoJoinDate:             "2024-06-01",
				DefaultCluster:          "Cluster A",
				DefaultClusterStartDate: "2024-09-06",
				DefaultClusterEndDate:   time.Now().AddDate(0, 0, 1).Format("2006-01-02"),
			},
			expectedCluster: "Cluster A",
			expectedEntitySave: entity.TrxCmoNoFPD{
				ProspectID:              "",
				BPKBName:                "",
				CMOID:                   "",
				CmoCategory:             "",
				CmoJoinDate:             "",
				DefaultCluster:          "",
				DefaultClusterStartDate: "",
				DefaultClusterEndDate:   "",
			},
			expectedError: nil,
		},
		{
			name:           "test CMO outside date range",
			prospectID:     "SAL0005",
			cmoID:          "CMO05",
			cmoCategory:    constant.CMO_BARU,
			cmoJoinDate:    "2024-08-01",
			defaultCluster: "Cluster D",
			bpkbName:       "NAMA CMO",
			mockReturnData: entity.TrxCmoNoFPD{
				ProspectID:              "SAL0005",
				BPKBName:                "NAMA CMO",
				CMOID:                   "CMO05",
				CmoCategory:             constant.CMO_BARU,
				CmoJoinDate:             "2024-08-01",
				DefaultCluster:          "Cluster D",
				DefaultClusterStartDate: "2024-05-01",
				DefaultClusterEndDate:   "2024-08-01",
			},
			expectedCluster: "",
			expectedEntitySave: entity.TrxCmoNoFPD{
				ProspectID:              "SAL0005",
				BPKBName:                "NAMA CMO",
				CMOID:                   "CMO05",
				CmoCategory:             constant.CMO_BARU,
				CmoJoinDate:             "2024-08-01",
				DefaultCluster:          "Cluster D",
				DefaultClusterStartDate: time.Now().Format("2006-01-02"),
				DefaultClusterEndDate: func() string {
					today := time.Now().Format("2006-01-02")
					todayTime, _ := time.Parse("2006-01-02", today)
					threeMonthsLater := todayTime.AddDate(0, 0, 0)
					threeMonthsLater = time.Date(threeMonthsLater.Year(), threeMonthsLater.Month(), 0, 0, 0, 0, 0, threeMonthsLater.Location())
					return threeMonthsLater.Format("2006-01-02")
				}(),
			},
			expectedError: nil,
		},
	}

	for _, tc := range testcases {
		t.Run(tc.name, func(t *testing.T) {
			mockRepository := new(mocks.Repository)
			mockHttpClient := new(httpclient.MockHttpClient)

			mockRepository.On("CheckCMONoFPD", tc.cmoID, tc.bpkbName).Return(tc.mockReturnData, tc.mockReturnError)

			usecase := NewUsecase(mockRepository, mockHttpClient)

			clusterCMOSaved, entitySaveTrxNoFPd, err := usecase.CheckCmoNoFPD(tc.prospectID, tc.cmoID, tc.cmoCategory, tc.cmoJoinDate, tc.defaultCluster, tc.bpkbName)
			require.Equal(t, tc.expectedCluster, clusterCMOSaved)
			require.Equal(t, tc.expectedEntitySave, entitySaveTrxNoFPd)
			require.Equal(t, tc.expectedError, err)
		})
	}
}

func TestCheckLatestPaidInstallment(t *testing.T) {
	os.Setenv("LASTEST_PAID_INSTALLMENT_URL", "http://10.9.100.231/los-int-dupcheck-v2/api/v2/mdm/installment/")
	os.Setenv("DEFAULT_TIMEOUT_30S", "30")

	timeout, _ := strconv.Atoi(os.Getenv("DEFAULT_TIMEOUT_30S"))
	ctx := context.Background()
	reqID := utils.GenerateUUID()
	ctx = context.WithValue(ctx, constant.HeaderXRequestID, reqID)
	accessToken := "token"

	testCases := []struct {
		name                string
		prospectID          string
		customerID          string
		accessToken         string
		mockResponse        string
		mockStatusCode      int
		expectedRespRrdDate string
		expectedMonthsDiff  int
		expectedError       error
	}{
		{
			name:                "Success case",
			prospectID:          "prospect1",
			customerID:          "customer1",
			mockResponse:        `{ "data": { "rrd_date": "` + time.Now().AddDate(0, -7, 0).Format("2006-01-02") + `T00:00:00Z" } }`,
			mockStatusCode:      200,
			expectedRespRrdDate: time.Now().AddDate(0, -7, 0).Format("2006-01-02"),
			expectedMonthsDiff:  7,
			expectedError:       nil,
		},
		{
			name:                "Unmarshal error case",
			prospectID:          "prospect1",
			customerID:          "customer1",
			mockResponse:        `{ "datas": { "rrd_date": "` + time.Now().AddDate(0, -7, 0).Format("2006-01-02") + `T00:00:00Z" } }`,
			mockStatusCode:      200,
			expectedRespRrdDate: "",
			expectedMonthsDiff:  0,
			expectedError:       errors.New(constant.ERROR_UPSTREAM + " - Unmarshal LatestPaidInstallmentData Error"),
		},
		{
			name:                "RRD Date higher than current date case",
			prospectID:          "prospect1",
			customerID:          "customer1",
			mockResponse:        `{ "data": { "rrd_date": "` + time.Now().AddDate(0, +1, 0).Format("2006-01-02") + `T00:00:00Z" } }`,
			mockStatusCode:      200,
			expectedRespRrdDate: time.Now().AddDate(0, +1, 0).Format("2006-01-02"),
			expectedMonthsDiff:  0,
			expectedError:       errors.New(constant.ERROR_UPSTREAM + " - Difference of months rrd_date and current_date is negative (-)"),
		},
		{
			name:                "Error case - empty RRDDate",
			prospectID:          "prospect2",
			customerID:          "customer2",
			mockResponse:        `{ "data": { "rrd_date": "" } }`,
			mockStatusCode:      200,
			expectedRespRrdDate: "",
			expectedMonthsDiff:  0,
			expectedError:       errors.New(constant.ERROR_UPSTREAM + " - Result LatestPaidInstallmentData rrd_date Empty String"),
		},
		{
			name:                "Error case - invalid date format",
			prospectID:          "prospect3",
			customerID:          "customer3",
			mockResponse:        `{ "data": { "rrd_date": "01-01-2020" } }`,
			mockStatusCode:      200,
			expectedRespRrdDate: "",
			expectedMonthsDiff:  0,
			expectedError:       errors.New(constant.ERROR_UPSTREAM + " - Error parsing date of response rrd_date (01-01-2020)"),
		},
		{
			name:                "Error case - upstream error",
			prospectID:          "prospect4",
			customerID:          "customer4",
			mockResponse:        `{}`,
			mockStatusCode:      500,
			expectedRespRrdDate: "",
			expectedMonthsDiff:  0,
			expectedError:       errors.New(constant.ERROR_UPSTREAM + " - Call LatestPaidInstallmentData Error"),
		},
	}

	for _, tc := range testCases {
		t.Run(tc.name, func(t *testing.T) {
			mockRepository := new(mocks.Repository)
			mockHttpClient := new(httpclient.MockHttpClient)

			rst := resty.New()
			httpmock.ActivateNonDefault(rst.GetClient())
			defer httpmock.DeactivateAndReset()

			httpmock.RegisterResponder(constant.METHOD_GET, os.Getenv("LASTEST_PAID_INSTALLMENT_URL")+tc.customerID+"/2", httpmock.NewStringResponder(tc.mockStatusCode, tc.mockResponse))
			resp, _ := rst.R().Get(os.Getenv("LASTEST_PAID_INSTALLMENT_URL") + tc.customerID + "/2")

			mockHttpClient.On("EngineAPI", ctx, constant.NEW_KMB_LOG, os.Getenv("LASTEST_PAID_INSTALLMENT_URL")+tc.customerID+"/2", []byte(nil), map[string]string{}, constant.METHOD_GET, false, 0, timeout, tc.prospectID, accessToken).Return(resp, nil).Once()
			usecase := NewUsecase(mockRepository, mockHttpClient)

			respRrdDate, monthsDiff, err := usecase.CheckLatestPaidInstallment(ctx, tc.prospectID, tc.customerID, accessToken)

			require.Equal(t, tc.expectedRespRrdDate, respRrdDate)
			require.Equal(t, tc.expectedMonthsDiff, monthsDiff)
			if tc.expectedError != nil {
				require.EqualError(t, err, tc.expectedError.Error())
			} else {
				require.NoError(t, err)
			}
		})
	}
}
